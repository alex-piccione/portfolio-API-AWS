# syntax ref.: https://www.serverless.com/framework/docs/providers/aws/guide/serverless.yml/
service: Portfolio-FSharp
configValidationMode: error

provider:
  name: aws
  runtime: dotnetcore3.1
  stackName: Portfolio-FSharp # CloudFormation stack name
  apiName: Portfolio-FSharp.2021 # API Gateway name  
  deploymentBucket:
    name: portfolio.api.fsharp-functions
  memorySize: 512
  lambdaHashingVersion: "20201221"

  #apiGateway:
  #  restApiId: portfolio-fsharp-2021
  # The CloudFormation template is invalid: Template error: instance of Fn::GetAtt references undefined resource ApiGatewayRestApi

  environment:
    functionCurrencyPrefix: "Portfolio.Api::Portfolio.Api.Functions.Currency" # Assembly::Namespace prefix, contatenate .Class::Method

package:
  individually: true

functions:
  currency_list:
    handler: ${self:provider.environment.functionCurrencyPrefix}.List::Handle   # assembly::namespace.class::method
    package: &package
      artifact: "FSharp project/publish/fsharp-functions.zip"
    events:
    - http:
        method: GET
        path: currency
        cors: true
